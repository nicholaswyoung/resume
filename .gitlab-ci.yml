variables:
  # NOTE: The build requires NETLIFY_AUTH_TOKEN
  # and NETLIFY_SITE_ID variables, too
  ZOLA_VERSION: "0.10.0"
  DEPLOY_PRIME_URL: "https://resume.nicholaswyoung.com"

stages:
  - test
  - deploy

test:
  image: node:latest
  script:
    - bash scripts/setup.sh
    - bash scripts/build.sh
  artifacts:
    paths:
      - public/
  except:
    - master

deploy:
  image: node:latest
  script:
    - bash scripts/setup.sh
    - bash scripts/build.sh
    - npm run deploy -- --prod
  artifacts:
    paths:
      - public/
  only:
    - master
